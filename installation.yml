---
# This playbook installs my necessary apt packages
- hosts: localhost
  connection: local
  become: true

  tasks:
  - name: Installing apt packages
    package: 
      name: 
       - htop
       - git
       - curl
       - tmux
       - tree
       - wget
       - stow
       - python3-psutil
       - clamav
       - clamav-daemon
       - ubuntu-restricted-extras
       - gstreamer1.0-plugins-bad 
       - gstreamer1.0-plugins-ugly 
       - gstreamer1.0-plugins-good 
       - libavcodec-extra 
       - gstreamer1.0-libav 
       - chromium-codecs-ffmpeg-extra 
       - libdvd-pkg 
       - libfuse2 
       - virtualbox 
       - virtualbox-ext-pack 
       - xclip 
       - gimp 
       - vlc
       - ninja-build
       - gettext
       - cmake
       - unzip
       - build-essential
       - npm

  - name: Make sure that zsh is installed
    apt: 
     name: zsh
     state: present
     update_cache: yes
    become: true

  - name: Make sure zsh is the default shell 
    user:
      name: gato
      shell: "/usr/bin/zsh"
    become: true
    
  - name: Download Oh My Zsh installation script
    get_url:
      url: https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh
      dest: /tmp/install_ohmyzsh.sh

  - name: Run Oh My Zsh installation script
    command: sh /tmp/install_ohmyzsh.sh --unattended
    register: ohmyzsh_result
    failed_when: "'FAILED' in ohmyzsh_result.stderr"

  - name: copy .zshrc file
    copy: 
     src: files/zshrc
     dest: /home/gato/.zshrc
     owner: gato
     group: gato

  - name: copy .tmux.conf
    copy: 
     src: files/tmux.conf
     dest: /home/gato/.tmux.conf
     owner: gato
     group: gato

